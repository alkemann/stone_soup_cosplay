#!/bin/bash

WEBPORT=${APP_PORT:-8080}

export CLEARDB_DATABASE_URL="mysql://${DB_USER}:${DB_PASS}@${DB_HOST}/${DB_SCHEMA}?reconnect=true"
export ENV='LOCAL'
export ADMIN="${APP_PASS}"

php -S 0.0.0.0:$WEBPORT -t webroot webroot/server.php &
SERVER_PID=$!

echo "Cosplay app server started on port ${WEBPORT} with PID: ${SERVER_PID}"

function gracefullyExit {
  echo "Stopping cosplay app server..."
  kill $SERVER_PID
  echo "DONE"
  exit 0
}

trap gracefullyExit SIGINT

while true; do
    sleep 1;
done
